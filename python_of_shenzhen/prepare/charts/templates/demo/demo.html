{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>


<div id="demo" style="height:800px"></div>



<script src="{% static 'demo/js/jquery.min.js' %}"></script>
<script src="{% static 'demo/js/echarts.js' %}"></script>
<script>
    $(function () {


        $.getJSON("{% url 'get-graphy' %}", function(callback){



        require.config({
            paths: {
                echarts: '{% static 'demo/js/dist' %}'
            }
        });

        require(
                [
                    'echarts',
                    'echarts/chart/pie',
                ],

                function (ec) {
                    var myChart = ec.init(document.getElementById('demo'));
                    var option = {
                        title: {
                            text: '某站点用户访问来源',
                            subtext: '纯属虚构',
                            x: 'center'
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: "{a} <br/>{b} : {c} ({d}%)"
                        },
                        legend: {
                            orient: 'vertical',
                            x: 'left',
                            data: callback.city
                        },
                        toolbox: {
                            show: true,
                            feature: {
                                mark: {show: true},
                                dataView: {show: true, readOnly: false},
                                magicType: {
                                    show: true,
                                    type: ['pie', 'funnel'],
                                    option: {
                                        funnel: {
                                            x: '25%',
                                            width: '50%',
                                            funnelAlign: 'left',
                                            max: 1548
                                        }
                                    }
                                },
                                restore: {show: true},
                                saveAsImage: {show: true}
                            }
                        },
                        calculable: true,
                        series: [
                            {
                                name: '访问来源',
                                type: 'pie',
                                radius: '55%',
                                center: ['50%', '60%'],
                                data: callback.haha
                            }
                        ]
                    };

                    myChart.setOption(option);
                }
        );

        })

    })


</script>
</body>


</html>